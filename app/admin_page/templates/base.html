<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coffee Shop Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for a better look in dark mode */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937; /* gray-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563; /* gray-600 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280; /* gray-500 */
        }

        /* Smooth transition for dropdowns (kept for profile menu) */
        .profile-menu {
            transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
        }

        .fade-enter-active, .fade-leave-active {
          transition: opacity 0.5s ease;
        }
        .fade-enter-from, .fade-leave-to {
          opacity: 0;
        }
    </style>
    {% block style %}
    {% endblock %}
</head>
<body class="bg-gray-100">
    <div id="app" class="relative min-h-screen md:flex">
        <aside id="sidebar" class="bg-gray-800 text-gray-100 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition duration-200 ease-in-out z-30">
            <a href="{{ url_for("admin_page.dashboard") }}" class="text-white flex mx-auto items-center space-x-2 px-4 bg-white rounded-full w-1/2 aspect-square">
               <img class="w-full" src="{{ url_for('admin_page.static',filename="images/coffee_cup.png") }}">
            </a>

            <nav class="space-y-2">
                <a href="{{ url_for('admin_page.dashboard') }}" class="flex items-center space-x-2 py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white {{ 'bg-gray-700 text-white' if active_page == 'dashboard' else '' }}">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                    <span class="uppercase">Dashboard</span>
                </a>
                
                <a href="{{ url_for('admin_page.admin_category_page') }}" class="flex items-center space-x-2 py-2.5 px-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white {{ 'bg-gray-700 text-white' if active_page == 'category' else '' }}">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                    <span class="uppercase">Category</span>
                </a>
                
                <div class="pt-2">
                    <div class="px-4 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider">
                        Product Manager
                    </div>
                    <a href="{{ url_for('admin_page.admin_product_page') }}" class="flex items-center space-x-2 py-2.5 pl-8 pr-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white {{ 'bg-gray-700 text-white' if active_page == 'product' else '' }}">
                        <span class="uppercase">Product Listing</span>
                    </a>
                    <a href="{{ url_for('admin_page.admin_create_product_page') }}" class="mt-2 flex items-center space-x-2 py-2.5 pl-8 pr-4 rounded transition duration-200 hover:bg-gray-700 hover:text-white {{ 'bg-gray-700 text-white' if active_page == 'product_create' else '' }}">
                        <span class="uppercase">New Product</span>
                    </a>
                </div>
            </nav>
        </aside>

        <div id="sidebar-overlay" class="hidden md:hidden fixed inset-0 bg-black bg-opacity-50 z-20"></div>

        <div class="flex-1 flex flex-col">
            <header class="bg-gray-900 text-white shadow-md">
                <div class="flex justify-between items-center p-4">
                    <button id="mobile-menu-button" class="md:hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                    {% if current_user.is_authenticated %}
                        <h1 class="text-xl font-semibold">Welcome Back, {{current_user.username}}</h1>
                    {% endif %}

                    <div class="flex items-center gap-5">
                        {# Start Search Form #}
                        <form action="" method="GET">
                            <input type="search" class="text-black outline-none focus:outline focus:outline-bg-green-500 min-w-[300px] px-3 py-2 border rounded" name="q" placeholder="Search here..."/>
                        </form>
                        {# End Search Form #}

                        <div class="relative">
                            <button id="profile-menu-button" class="h-9 w-9 rounded-full bg-gray-700 flex items-center justify-center hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-white">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
                                </svg>
                            </button>
                            <div id="profile-menu" class="profile-menu hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 ring-1 ring-black ring-opacity-5 z-20">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Your Profile</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                                <a href="{{ url_for('auth_logout') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
                            </div>
                        </div>
                    </div>

                </div>
            </header>

            <main class="flex-1 p-6 bg-gray-100 relative">
                {% block content %}
                {% endblock %}
            </main>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- Elements ---
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const profileMenuButton = document.getElementById('profile-menu-button');
            const profileMenu = document.getElementById('profile-menu');

            // --- Sidebar Logic ---
            function toggleSidebar() {
                sidebar.classList.toggle('-translate-x-full');
                sidebarOverlay.classList.toggle('hidden');
            }
            mobileMenuButton.addEventListener('click', toggleSidebar);
            sidebarOverlay.addEventListener('click', toggleSidebar);
            
            // --- Profile Menu Logic ---
            profileMenuButton.addEventListener('click', (e) => {
                e.stopPropagation(); // Prevent this click from being caught by the window listener
                profileMenu.classList.toggle('hidden');
            });

            // Hide profile menu if clicking outside of it
            window.addEventListener('click', function(e) {
                if (!profileMenu.classList.contains('hidden') && !profileMenuButton.contains(e.target) && !profileMenu.contains(e.target)) {
                    profileMenu.classList.add('hidden');
                }
            });

            // *** NOTE: All JavaScript for the product dropdown has been removed as it is no longer interactive. ***
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.11.0/axios.min.js" integrity="sha512-h9644v03pHqrIHThkvXhB2PJ8zf5E9IyVnrSfZg8Yj8k4RsO4zldcQc4Bi9iVLUCCsqNY0b4WXVV4UB+wbWENA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    {% block script %}
    {% endblock %}
</body>
</html>